<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯ | SODmAX Pro</title>
    
    <!-- Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ -->
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯ */
        .leaderboard {
            padding: 20px 0;
        }
        
        .leaderboard-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .leaderboard-title {
            font-size: 32px;
            font-weight: 900;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .leaderboard-filters {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 10px 20px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn.active {
            background: var(--gradient);
            color: white;
            border-color: transparent;
        }
        
        .top-three {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .podium-item {
            text-align: center;
            padding: 30px 20px;
            border-radius: var(--radius-lg);
            background: linear-gradient(145deg, var(--card) 0%, rgba(18, 24, 40, 0.95) 100%);
            border: 1px solid var(--glass-border);
            position: relative;
        }
        
        .podium-item.first {
            border-color: #FFD700;
            background: linear-gradient(145deg, var(--card) 0%, rgba(255, 215, 0, 0.1) 100%);
        }
        
        .podium-item.second {
            border-color: #C0C0C0;
            background: linear-gradient(145deg, var(--card) 0%, rgba(192, 192, 192, 0.1) 100%);
        }
        
        .podium-item.third {
            border-color: #CD7F32;
            background: linear-gradient(145deg, var(--card) 0%, rgba(205, 127, 50, 0.1) 100%);
        }
        
        .rank-number {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 40px;
            height: 40px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            color: white;
        }
        
        .user-avatar {
            width: 80px;
            height: 80px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 900;
            color: white;
            margin: 0 auto 15px;
        }
        
        .user-name {
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .user-email {
            color: var(--text-secondary);
            font-size: 12px;
            margin-bottom: 10px;
        }
        
        .user-stats {
            margin-top: 15px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--glass-border);
        }
        
        .stat-item:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 12px;
        }
        
        .stat-value {
            font-weight: 600;
            font-size: 14px;
        }
        
        .leaderboard-list {
            background: var(--card);
            border-radius: var(--radius-lg);
            border: 1px solid var(--glass-border);
            overflow: hidden;
        }
        
        .leaderboard-row {
            display: grid;
            grid-template-columns: 60px 1fr 150px 150px 100px;
            gap: 15px;
            padding: 15px 20px;
            border-bottom: 1px solid var(--glass-border);
            align-items: center;
        }
        
        .leaderboard-row.header {
            background: rgba(0, 102, 255, 0.2);
            font-weight: 700;
            font-size: 14px;
        }
        
        .leaderboard-row:last-child {
            border-bottom: none;
        }
        
        .leaderboard-row.current-user {
            background: rgba(0, 212, 170, 0.1);
            border-left: 4px solid var(--secondary);
        }
        
        .row-rank {
            text-align: center;
            font-weight: 900;
            font-size: 18px;
        }
        
        .row-user {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .row-user-avatar {
            width: 40px;
            height: 40px;
            background: var(--gradient);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            color: white;
        }
        
        .row-user-info {
            flex: 1;
        }
        
        .row-user-name {
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .row-user-email {
            color: var(--text-secondary);
            font-size: 11px;
        }
        
        .refresh-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin: 30px auto;
            padding: 12px 30px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .top-three {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .leaderboard-row {
                grid-template-columns: 50px 1fr;
                grid-template-rows: auto auto;
                gap: 10px;
                padding: 15px;
            }
            
            .leaderboard-row.header {
                display: none;
            }
            
            .row-sod, .row-mined, .row-level {
                grid-column: 2;
                display: flex;
                justify-content: space-between;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <!-- Ù†Ø§ÙˆØ¨Ø±ÛŒ -->
    <nav class="navbar">
        <div class="container nav-content">
            <a href="index.html" class="logo">
                <div class="logo-icon">â›ï¸</div>
                <div class="logo-text">
                    <h1>SODmAX Pro</h1>
                    <p>Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø±ØªØ±ÛŒÙ†â€ŒÙ‡Ø§</p>
                </div>
            </a>
            
            <div style="display: flex; gap: 10px; align-items: center;">
                <a href="index.html" class="btn btn-outline btn-small">
                    <i class="fas fa-home"></i> ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ
                </a>
                <a href="dashboard.html" class="btn btn-outline btn-small">
                    <i class="fas fa-chart-line"></i> Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
                </a>
                <a href="missions.html" class="btn btn-outline btn-small">
                    <i class="fas fa-tasks"></i> Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§
                </a>
            </div>
        </div>
    </nav>
    
    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯ -->
    <div class="container leaderboard">
        <!-- Ù‡Ø¯Ø± -->
        <div class="leaderboard-header">
            <h1 class="leaderboard-title">ğŸ† Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯ SODmAX</h1>
            <p style="color: var(--text-secondary); max-width: 600px; margin: 0 auto;">
                Ø¨Ø±ØªØ±ÛŒÙ† Ù…Ø§ÛŒÙ†Ø±Ù‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø¬Ù…ÙˆØ¹ SOD Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡. Ù‡Ø± Û²Û´ Ø³Ø§Ø¹Øª Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
            </p>
        </div>
        
        <!-- ÙÛŒÙ„ØªØ±Ù‡Ø§ -->
        <div class="leaderboard-filters">
            <button class="filter-btn active" onclick="filterLeaderboard('total_mined')">
                Ù…Ø¬Ù…ÙˆØ¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬
            </button>
            <button class="filter-btn" onclick="filterLeaderboard('sod_balance')">
                Ù…ÙˆØ¬ÙˆØ¯ÛŒ SOD
            </button>
            <button class="filter-btn" onclick="filterLeaderboard('user_level')">
                Ø³Ø·Ø­ Ú©Ø§Ø±Ø¨Ø±ÛŒ
            </button>
            <button class="filter-btn" onclick="filterLeaderboard('today_earnings')">
                Ø§Ù…Ø±ÙˆØ²
            </button>
        </div>
        
        <!-- Ø³Ù‡ Ù†ÙØ± Ø¨Ø±ØªØ± -->
        <div class="top-three" id="topThree">
            <!-- Ø¨Ø§ JS Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
            <div class="podium-item" style="text-align: center; padding: 30px;">
                <div class="loader"></div>
            </div>
        </div>
        
        <!-- Ù„ÛŒØ³Øª Ú©Ø§Ù…Ù„ -->
        <div class="leaderboard-list">
            <!-- Ù‡Ø¯Ø± -->
            <div class="leaderboard-row header">
                <div class="row-rank">Ø±ØªØ¨Ù‡</div>
                <div class="row-user">Ú©Ø§Ø±Ø¨Ø±</div>
                <div class="row-sod">Ù…ÙˆØ¬ÙˆØ¯ÛŒ SOD</div>
                <div class="row-mined">Ú©Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬</div>
                <div class="row-level">Ø³Ø·Ø­</div>
            </div>
            
            <!-- Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† -->
            <div id="leaderboardList">
                <!-- Ø¨Ø§ JS Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                <div class="leaderboard-row" style="text-align: center; padding: 30px;">
                    Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...
                </div>
            </div>
        </div>
        
        <!-- Ø¯Ú©Ù…Ù‡ Ø±ÙØ±Ø´ -->
        <button class="refresh-btn" onclick="loadLeaderboard()">
            <i class="fas fa-sync-alt"></i> Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
        </button>
        
        <!-- Ø±ØªØ¨Ù‡ Ø´Ù…Ø§ -->
        <div class="card" style="margin-top: 40px; text-align: center;">
            <h3 style="margin-bottom: 15px;">ğŸ¯ Ø±ØªØ¨Ù‡ Ø´Ù…Ø§</h3>
            <div id="userRank" style="font-size: 48px; font-weight: 900; color: var(--primary); margin-bottom: 10px;">
                --
            </div>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">
                Ø§Ø² Ø¨ÛŒÙ† <span id="totalPlayers">Û°</span> Ø¨Ø§Ø²ÛŒÚ©Ù†
            </p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-top: 30px;">
                <div>
                    <div style="color: var(--text-secondary); font-size: 14px;">Ú©Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ù…Ø§</div>
                    <div style="font-size: 20px; font-weight: 900;" id="userTotalMined">Û°</div>
                </div>
                
                <div>
                    <div style="color: var(--text-secondary); font-size: 14px;">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø´Ù…Ø§</div>
                    <div style="font-size: 20px; font-weight: 900;" id="userSODBalance">Û°</div>
                </div>
                
                <div>
                    <div style="color: var(--text-secondary); font-size: 14px;">ÙØ§ØµÙ„Ù‡ ØªØ§ Ø±ØªØ¨Ù‡ Ø¨Ø§Ù„Ø§ØªØ±</div>
                    <div style="font-size: 20px; font-weight: 900;" id="nextRankDiff">Û°</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="utils.js"></script>
    
    <script>
        // ==================== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ ====================
        let currentUser = null;
        let leaderboardData = [];
        let currentFilter = 'total_mined';
        
        // ==================== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ ====================
        
        async function initLeaderboard() {
            try {
                // Ø¨Ø±Ø±Ø³ÛŒ session
                const { data: { session } } = await window.supabaseClient.auth.getSession();
                
                if (session) {
                    currentUser = session.user;
                }
                
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯
                await loadLeaderboard();
                
                console.log('âœ… Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯');
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯:', error);
                showError('Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯ Ù¾ÛŒØ´ Ø¢Ù…Ø¯');
            }
        }
        
        async function loadLeaderboard() {
            try {
                showLoading(true);
                
                // Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯
                const { data, error } = await window.supabaseClient
                    .from('game_data')
                    .select(`
                        sod_balance,
                        total_mined,
                        today_earnings,
                        user_level,
                        users (
                            id,
                            email,
                            full_name,
                            invite_code,
                            register_date
                        )
                    `)
                    .order(currentFilter, { ascending: false })
                    .limit(100);
                
                if (error) throw error;
                
                leaderboardData = data || [];
                
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
                updateLeaderboardUI();
                
                showMessage('Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯', 'success');
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯:', error);
                showError('Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾ÛŒØ´ Ø¢Ù…Ø¯');
            } finally {
                showLoading(false);
            }
        }
        
        // ==================== Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI ====================
        
        function updateLeaderboardUI() {
            updateTopThree();
            updateLeaderboardList();
            updateUserRank();
        }
        
        function updateTopThree() {
            const topThree = leaderboardData.slice(0, 3);
            const container = document.getElementById('topThree');
            
            if (topThree.length === 0) {
                container.innerHTML = `
                    <div class="podium-item" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">ğŸ†</div>
                        <h3 style="margin-bottom: 10px;">Ù‡Ù†ÙˆØ² Ø¨Ø§Ø²ÛŒÚ©Ù†ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</h3>
                        <p style="color: var(--text-secondary);">Ø§ÙˆÙ„ÛŒÙ† Ù†ÙØ±ÛŒ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ø±ØªØ¨Ù‡ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯!</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            // Ø§Ú¯Ø± ÙÙ‚Ø· Û± ÛŒØ§ Û² Ù†ÙØ± Ø¨Ø§Ø´Ù†Ø¯ØŒ layout Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†
            const positions = [
                { class: 'second', order: 2 },
                { class: 'first', order: 1 },
                { class: 'third', order: 3 }
            ];
            
            positions.forEach((pos, index) => {
                if (index < topThree.length) {
                    const user = topThree[index];
                    const userInfo = user.users || {};
                    
                    html += `
                        <div class="podium-item ${pos.class}">
                            <div class="rank-number">${pos.order}</div>
                            <div class="user-avatar">
                                ${userInfo.full_name?.charAt(0) || userInfo.email?.charAt(0) || '?'}
                            </div>
                            <div class="user-name">${userInfo.full_name || userInfo.email?.split('@')[0] || 'Ù†Ø§Ø´Ù†Ø§Ø³'}</div>
                            <div class="user-email">${userInfo.email || ''}</div>
                            
                            <div class="user-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Ù…ÙˆØ¬ÙˆØ¯ÛŒ:</span>
                                    <span class="stat-value">${window.NumberUtils.formatNumber(user.sod_balance || 0)}</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Ú©Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬:</span>
                                    <span class="stat-value">${window.NumberUtils.formatNumber(user.total_mined || 0)}</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Ø³Ø·Ø­:</span>
                                    <span class="stat-value">${user.user_level || 1}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
            });
            
            container.innerHTML = html;
        }
        
        function updateLeaderboardList() {
            const list = leaderboardData.slice(3); // Ø¨Ø¹Ø¯ Ø§Ø² Û³ Ù†ÙØ± Ø§ÙˆÙ„
            const container = document.getElementById('leaderboardList');
            
            if (list.length === 0) {
                container.innerHTML = `
                    <div class="leaderboard-row" style="text-align: center; padding: 30px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">ğŸ“Š</div>
                        <h3 style="margin-bottom: 10px;">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ±ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</h3>
                        <p style="color: var(--text-secondary);">Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø¨ÛŒØ´ØªØ±ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù„Ø§Ø²Ù… Ø§Ø³Øª</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            list.forEach((user, index) => {
                const userInfo = user.users || {};
                const rank = index + 4;
                const isCurrentUser = currentUser && userInfo.id === currentUser.id;
                
                html += `
                    <div class="leaderboard-row ${isCurrentUser ? 'current-user' : ''}">
                        <div class="row-rank">${rank}</div>
                        <div class="row-user">
                            <div class="row-user-avatar">
                                ${userInfo.full_name?.charAt(0) || userInfo.email?.charAt(0) || '?'}
                            </div>
                            <div class="row-user-info">
                                <div class="row-user-name">${userInfo.full_name || userInfo.email?.split('@')[0] || 'Ù†Ø§Ø´Ù†Ø§Ø³'}</div>
                                <div class="row-user-email">${userInfo.email || ''}</div>
                            </div>
                        </div>
                        <div class="row-sod">${window.NumberUtils.formatNumber(user.sod_balance || 0)}</div>
                        <div class="row-mined">${window.NumberUtils.formatNumber(user.total_mined || 0)}</div>
                        <div class="row-level">${user.user_level || 1}</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù†
            document.getElementById('totalPlayers').textContent = leaderboardData.length;
        }
        
        function updateUserRank() {
            if (!currentUser || leaderboardData.length === 0) {
                document.getElementById('userRank').textContent = '--';
                document.getElementById('userTotalMined').textContent = 'Û°';
                document.getElementById('userSODBalance').textContent = 'Û°';
                document.getElementById('nextRankDiff').textContent = '--';
                return;
            }
            
            // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø±ØªØ¨Ù‡ Ú©Ø§Ø±Ø¨Ø±
            const userIndex = leaderboardData.findIndex(item => 
                item.users && item.users.id === currentUser.id
            );
            
            if (userIndex === -1) {
                document.getElementById('userRank').textContent = '--';
                document.getElementById('userTotalMined').textContent = 'Û°';
                document.getElementById('userSODBalance').textContent = 'Û°';
                document.getElementById('nextRankDiff').textContent = '--';
                return;
            }
            
            const rank = userIndex + 1;
            const userData = leaderboardData[userIndex];
            
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ ÙØ§ØµÙ„Ù‡ ØªØ§ Ø±ØªØ¨Ù‡ Ø¨Ø§Ù„Ø§ØªØ±
            let nextRankDiff = '--';
            if (rank > 1) {
                const higherRankData = leaderboardData[rank - 2];
                const diff = (higherRankData.total_mined || 0) - (userData.total_mined || 0);
                if (diff > 0) {
                    nextRankDiff = window.NumberUtils.formatNumber(diff) + ' SOD';
                }
            }
            
            // Ø¢Ù¾Ø¯ÛŒØª UI
            document.getElementById('userRank').textContent = rank;
            document.getElementById('userTotalMined').textContent = window.NumberUtils.formatNumber(userData.total_mined || 0);
            document.getElementById('userSODBalance').textContent = window.NumberUtils.formatNumber(userData.sod_balance || 0);
            document.getElementById('nextRankDiff').textContent = nextRankDiff;
        }
        
        // ==================== ÙÛŒÙ„ØªØ±Ù‡Ø§ ====================
        
        async function filterLeaderboard(filter) {
            // Ø¢Ù¾Ø¯ÛŒØª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ ÙÛŒÙ„ØªØ±
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            currentFilter = filter;
            await loadLeaderboard();
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ ====================
        
        function showLoading(show) {
            if (show) {
                // Ù†Ù…Ø§ÛŒØ´ Ù„ÙˆØ¯Ø±
                const loader = document.createElement('div');
                loader.id = 'globalLoader';
                loader.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                    backdrop-filter: blur(5px);
                `;
                loader.innerHTML = `
                    <div class="loader" style="width: 60px; height: 60px; border-width: 4px;"></div>
                `;
                document.body.appendChild(loader);
            } else {
                const loader = document.getElementById('globalLoader');
                if (loader) loader.remove();
            }
        }
        
        function showMessage(message, type = 'info') {
            const colors = {
                success: '#00C853',
                error: '#FF3D00',
                info: '#0066FF',
                warning: '#FFB300'
            };
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--card);
                border: 1px solid var(--glass-border);
                border-left: 4px solid ${colors[type] || colors.info};
                border-radius: var(--radius);
                padding: 15px 20px;
                display: flex;
                align-items: center;
                gap: 15px;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                max-width: 400px;
            `;
            
            notification.innerHTML = `
                <div style="font-size: 20px;">${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸'}</div>
                <div>
                    <div style="font-weight: bold;">${type === 'success' ? 'Ù…ÙˆÙÙ‚ÛŒØª' : type === 'error' ? 'Ø®Ø·Ø§' : type === 'warning' ? 'Ù‡Ø´Ø¯Ø§Ø±' : 'Ø§Ø·Ù„Ø§Ø¹'}</div>
                    <div style="color: var(--text-secondary); font-size: 14px;">${message}</div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        function showError(message) {
            showMessage(message, 'error');
        }
        
        // ==================== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ ====================
        
        document.addEventListener('DOMContentLoaded', function() {
            initLeaderboard();
            
            // Ø±ÙØ±Ø´ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ø± 60 Ø«Ø§Ù†ÛŒÙ‡
            setInterval(() => {
                loadLeaderboard();
            }, 60000);
        });
    </script>
</body>
</html>
